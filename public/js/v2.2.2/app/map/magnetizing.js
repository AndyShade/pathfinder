define(["jquery","app/map/util","farahey"],(t,e)=>{"use strict";let n={},o=t=>n.hasOwnProperty(t),l=t=>o(t)?n[t]:null;return{initMagnetizer:l=>{let a=l.data("id");if(!o(a)){let o=l.getSystems(),r=t=>{let e=e=>{let n=t.style[e];return parseInt(n.substring(0,n.length-2))};return{left:e("left"),top:e("top")}},i=(n,o)=>{o.left=Math.round(o.left),o.top=Math.round(o.top);let l=o.left+"px",a=o.top+"px",r=!1;o.left>=0&&o.left<=2300&&n.style.left!==l&&(n.style.left=l,r=!0),o.top>=0&&o.top<=1400&&n.style.top!==a&&(n.style.top=a,r=!0),r&&e.markAsChanged(t(n))},s=t=>{let n=["jtk-drag",e.config.systemLockedClass];return![...document.getElementById(t).classList].some(t=>n.indexOf(t)>=0)},d=(t,n)=>(o,a,r)=>l.hasClass(e.config.mapGridClass)?{left:t*Math.floor((Math.round(a[0])+r.left)/t)-a[0],top:n*Math.floor((Math.round(a[1])+r.top)/n)-a[1]}:(r.left=Math.round(r.left),r.top=Math.round(r.top),r);((t,e)=>{t&&e&&(n[t]=e)})(a,window.Farahey.getInstance({container:l,getContainerPosition:t=>t.offset(),getPosition:r,getSize:t=>{let e=t.getBoundingClientRect();return[Math.floor(e.width),Math.floor(e.height)]},getId:t=>t.id,setPosition:i,elements:o.toArray(),filter:s,padding:[3,3],constrain:d(e.config.mapSnapToGridDimension,e.config.mapSnapToGridDimension),executeNow:!1,excludeFocus:!0}))}},destroyMagnetizer:t=>{let e=t.data("id"),o=l(e);o&&(o.reset(),delete n[e])},executeAtEvent:(e,n)=>{let o=t(e.getContainer()).data("id"),a=l(o);a&&n&&(a.executeAtEvent(n,{iterations:2,excludeFocus:!0}),e.repaintEverything())},addElement:(t,e,n)=>{let o=l(t);o&&o.addElement(e,n)},removeElement:(t,e)=>{let n=l(t);n&&n.removeElement(e)}}});
//# sourceMappingURL=magnetizing.js.map
